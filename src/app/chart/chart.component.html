<div class="w-full">
  <div class="bg-white rounded-lg">
    <div class="p-5 border-b border-gray-100">
      <h3 class="text-xl font-semibold text-gray-800 flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3m0 0l3 3m-3-3v7m6-2v2m-6 0h.01M9 20h6a2 2 0 002-2V8a2 2 0 00-2-2H9a2 2 0 00-2 2v10a2 2 0 002 2z" />
        </svg>
        Price Trends
      </h3>
    </div>    
    <!-- Dataset Selection Controls -->
    
    
    <!-- Loading Spinner -->
    <div *ngIf="loading" class="flex justify-center items-center h-64">
      <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
    </div>
    
    <!-- Error Message -->
    <div *ngIf="error" class="text-red-500 text-center py-8">
      Failed to load chart data. Please try again later.
      <button (click)="fetchChartData()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
        Retry
      </button>
    </div>
    
    <!-- Chart Canvas -->
    <div *ngIf="!loading && !error" >
      <div class="h-64 md:h-96 mb-6">
        <canvas baseChart
          [data]="lineChartData"
          [options]="lineChartOptions"
          [type]="lineChartType">
        </canvas>
      </div>
    </div>
    <div *ngIf="!loading && !error" class="ml-10 mb-4 flex flex-wrap gap-1">
      <div class="flex flex-wrap gap-1">
        <!-- Compact Toggle Button Template -->
        <label class="relative inline-flex items-center cursor-pointer text-sm">
          <input type="checkbox"
                [checked]="datasetSelections.aictc"
                (change)="toggleDataset('aictc')"
                class="sr-only peer">
          <div class="w-9 h-5 bg-gray-200 rounded-full peer peer-checked:bg-blue-500 peer-focus:ring-1 peer-focus:ring-blue-300"></div>
          <div class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full transition peer-checked:translate-x-4"></div>
          <span class="ml-2 text-gray-700 flex items-center font-medium">
            <span class="block w-2.5 h-2.5 mr-1 bg-blue-500 rounded-full"></span>
            AICTC
          </span>
        </label>
    
        <label class="relative inline-flex items-center cursor-pointer text-sm">
          <input type="checkbox"
                [checked]="datasetSelections.emt"
                (change)="toggleDataset('emt')"
                class="sr-only peer">
          <div class="w-9 h-5 bg-gray-200 rounded-full peer peer-checked:bg-green-500 peer-focus:ring-1 peer-focus:ring-green-300"></div>
          <div class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full transition peer-checked:translate-x-4"></div>
          <span class="ml-2 text-gray-700 flex items-center font-medium">
            <span class="block w-2.5 h-2.5 mr-1 bg-green-500 rounded-full"></span>
            EMT
          </span>
        </label>
    
        <label class="relative inline-flex items-center cursor-pointer text-sm">
          <input type="checkbox"
                [checked]="datasetSelections.mf"
                (change)="toggleDataset('mf')"
                class="sr-only peer">
          <div class="w-9 h-5 bg-gray-200 rounded-full peer peer-checked:bg-red-500 peer-focus:ring-1 peer-focus:ring-red-300"></div>
          <div class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full transition peer-checked:translate-x-4"></div>
          <span class="ml-2 text-gray-700 flex items-center font-medium">
            <span class="block w-2.5 h-2.5 mr-1 bg-red-500 rounded-full"></span>
            MF
          </span>
        </label>
      </div>
    </div>
    
  </div>
</div>
